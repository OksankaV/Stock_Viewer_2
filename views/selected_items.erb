<% content_for :head do %>
	<script type="text/javascript">

	$(document).ready(function() {
				$("#select_items_table").flexigrid({
					url: '/table_selected_items',
					dataType: "json",
					colModel : [
						{display: "<%=Table_Headers['brand']%>", name : 'brand', width : 100, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['family']%>", name : 'family', width : 150, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['dimensiontype']%>", name : 'dimensiontype', width : 130, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['sidewall']%>", name : 'sidewall', width : 60, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['origin']%>", name : 'origin', width : 55, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['runflat']%>", name : 'runflat', width : 50, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['productiondate']%>", name : 'productiondate', width : 40, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['season']%>", name : 'season', width : 40, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['remain']%>", name : 'remain', width : 50, sortable : true, align: 'left'},
						<%if @admin_login == true%>{display: "<%=Table_Headers['supplier']%>", name : 'supplier', width : 55, sortable : true, align: 'left'},<%end%>
						{display: "<%=Table_Headers['suppliercomment']%>", name : 'suppliercomment', width : 85, sortable : true, align: 'left'},
						<%if @admin_login == true%>{display: "<%=Table_Headers['rp']%>", name : 'rp', width : 80, sortable : true, align: 'left'},<%end%>
						{display: "<%=Table_Headers['bp']%>", name : 'bp', width : 75, sortable : true, align: 'left'},
						<%if @admin_login == true%>{display: "<%=Table_Headers['sp']%>", name : 'sp', width : 70, sortable : true, align: 'left'},<%end%>
						{display: "<%=Table_Headers['bpvat']%>", name : 'bpvat', width : 110, sortable : true, align: 'left'},
						{display: "<%=Table_Headers['actualdate']%>", name : 'actualdate', width : 70, sortable : true, align: 'left'}
						<%if @admin_login == true%>,
						{display: "<%=Table_Headers['sourcestring']%>", name : 'sourcestring', width : 600, sortable : true, align: 'left'}<%end%>
						],
					params: <%=@checked_array.to_json%>,	
					sortname: "rp",
					sortorder: "asc",
					usepager: true,
					useRp: true,
					rp: 100,
					showTableToggleBtn: true,
					width: setWidth(),
					height: setHeight()
				});
		
		$('#back_button').click(function(){
			parent.history.back();
			return false;
		});
		
		<%if @admin_login == true%>
		$('.nav').delegate('#show_columns','click', function (e) {
			$('tr td[class="ndcol1"] input[value="9"]').parents('tr').children('td.ndcol2').click();
			$('tr td[class="ndcol1"] input[value="11"]').parents('tr').children('td.ndcol2').click();	
			$('tr td[class="ndcol1"] input[value="13"]').parents('tr').children('td.ndcol2').click();
			$('tr td[class="ndcol1"] input[value="16"]').parents('tr').children('td.ndcol2').click();
			
			if ($('td[class="ndcol1"] input[value="9"]').is(':checked') && $('td[class="ndcol1"] input[value="11"]').is(':checked') && $('td[class="ndcol1"] input[value="13"]').is(':checked') && $('td[class="ndcol1"] input[value="16"]').is(':checked'))
				$("#show_columns").text("Неповний каталог");
			else
				$("#show_columns").text("Повний каталог");
		});
		<%end%>

	});
	

		function setHeight(){
			var value_height = $(window).height() - $("#filter_form").outerHeight(true) - 200;
			return value_height
		}

		function setWidth(){
			return $("#content").width() - 10;
		}

	</script>
	<style>
		body {	
			font-family: Verdana,Arial,Geneva,Helvetica,sans-serif;
			font-size: 12px;
		}

		.flexigrid div.pDiv2 {
			padding-left: 15%;
			font-family: Verdana,Arial,Geneva,Helvetica,sans-serif;
			font-size: 12px;
		}
		.wrap_value{ 
			white-space: nowrap; 
			overflow: hidden; 
			text-overflow: ellipsis; 
	   	}
	   	.rp_dropdown
		{
			height: 25px;
			width: 70px;
			padding: 2px;
		}
	   	.span3 { margin-left: 1%; }

		.row-fluid .span21, .row-fluid .span22 {
			min-height: 0px;
		}
		.row-fluid .span3, .row-fluid .span2{
			min-height: 0px;
			cursor: pointer;
		}
		.span4 .input-append{
			cursor: pointer;
		}
		#show_columns{
			cursor: pointer;
		}
		.back_button{
			margin-top: 10px;
		}
		
	</style>
<%end%>

		<%if @show_table%>
			<table id="select_items_table"></table>
		<%else%>
			<div id="message_id" class="alert alert-info" align="center">
				<strong><%=@message%></strong>
    		</div>
		<%end%>
		<div class="back_button" align="center">
			<form action="/excel_file" method="POST">
				<button class="btn" id="back_button" ><i class="icon-arrow-left"></i> <strong>Повернутися до фільтру</strong></button>
				<button class="btn" id="excel_button" type="submit"><i class="icon-file"></i><strong> Зберегти у Excel-файл</strong></button>
				<input type="hidden" name="excel_button" value='<%=@checked_array.to_json%>'>
			</form>	
		</div>
