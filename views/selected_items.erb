<% content_for :head do %>
	<script type="text/javascript">

	$(document).ready(function() {
				$("#select_items_table").flexigrid({
					url: '/table_selected_items',
					dataType: "json",
					colModel : [
						{display: 'Виробник', name : 'brand', width : 80, sortable : true, align: 'left'},
						{display: 'Марка', name : 'family', width : 120, sortable : true, align: 'left'},
						{display: 'Типорозмір', name : 'dimensiontype', width : 120, sortable : true, align: 'left'},
						{display: 'Боковина', name : 'sidewall', width : 60, sortable : true, align: 'left'},
						{display: 'Країна', name : 'origin', width : 50, sortable : true, align: 'left'},
						{display: 'Run Flat', name : 'runflat', width : 50, sortable : true, align: 'left'},
						{display: 'DOT', name : 'productiondate', width : 40, sortable : true, align: 'left'},
						{display: 'Сезон', name : 'season', width : 40, sortable : true, align: 'left'},
						{display: 'Залишок', name : 'remain', width : 50, sortable : true, align: 'left'},
						<%if @admin_login == true%>{display: 'Склад', name : 'supplier', width : 50, sortable : true, align: 'left'},<%end%>
						{display: 'Постачальник', name : 'suppliercomment', width : 80, sortable : true, align: 'left'},
						{display: 'Роздрібна ціна', name : 'rp', width : 80, sortable : true, align: 'left'},
						{display: 'Гуртова ціна', name : 'bp', width : 70, sortable : true, align: 'left'},
						<%if @admin_login == true%>{display: 'Вхідна ціна', name : 'sp', width : 70, sortable : true, align: 'left'},<%end%>
						{display: 'Гуртова ціна з ПДВ', name : 'bpvat', width : 100, sortable : true, align: 'left'},
						{display: 'Дата', name : 'actualdate', width : 70, sortable : true, align: 'left'}
						<%if @admin_login == true%>,
						{display: 'Вхідний рядок', name : 'sourcestring', width : 600, sortable : true, align: 'left'}<%end%>
						],
					params: <%=@checked_array.to_json%>,	
					sortname: "rp",
					sortorder: "asc",
					usepager: true,
					useRp: true,
					rp: 100,
					showTableToggleBtn: true,
					width: setWidth(),
					height: setHeight()
				});
		
		$('#back_button').click(function(){
			parent.history.back();
			return false;
		});
		
		<%if @admin_login == true%>
		$('.nav').delegate('#show_columns','click', function (e) {
			$('#show_columns').find('span').toggle();
			if ($('td[abbr="supplier"]').is(':hidden'))
			{
				$("#show_columns").text("Неповний каталог");
				$('td[abbr="supplier"]').removeAttr('style');
				$('th[abbr="supplier"]').removeAttr('hidden');
				$('th[abbr="supplier"]').removeAttr('style');
				
				$('td[abbr="sp"]').removeAttr('style');
				$('th[abbr="sp"]').removeAttr('hidden');
				$('th[abbr="sp"]').removeAttr('style');
				
				$('td[abbr="sourcestring"]').removeAttr('style');
				$('th[abbr="sourcestring"]').removeAttr('hidden');
				$('th[abbr="sourcestring"]').removeAttr('style');
			}
			else
			{
				$("#show_columns").text("Повний каталог");
				$('td[abbr="supplier"]').attr('style',"display: none;");
				$('th[abbr="supplier"]').attr('hidden',"");
				
				$('td[abbr="sp"]').attr('style',"display: none;");
				$('th[abbr="sp"]').attr('hidden',"");
				
				$('td[abbr="sourcestring"]').attr('style',"display: none;");
				$('th[abbr="sourcestring"]').attr('hidden',"");
			} 
		});
		<%end%>

	});
	

		function setHeight(){
			var value_height = $(window).height() - $("#filter_form").outerHeight(true) - 200;
			return value_height
		}

		function setWidth(){
			return $("#content").width() - 10;
		}

	</script>
	<style>
		body {	
			font-family: Verdana,Arial,Geneva,Helvetica,sans-serif;
			font-size: 12px;
		}

		.flexigrid div.pDiv2 {
			padding-left: 15%;
			font-family: Verdana,Arial,Geneva,Helvetica,sans-serif;
			font-size: 12px;
		}
		.wrap_value{ 
			white-space: nowrap; 
			overflow: hidden; 
			text-overflow: ellipsis; 
	   	}
	   	.rp_dropdown
		{
			height: 25px;
			width: 70px;
			padding: 2px;
		}
	   	.span3 { margin-left: 1%; }

		.row-fluid .span21, .row-fluid .span22 {
			min-height: 0px;
		}
		.row-fluid .span3, .row-fluid .span2{
			min-height: 0px;
			cursor: pointer;
		}
		.span4 .input-append{
			cursor: pointer;
		}
		#show_columns{
			cursor: pointer;
		}
		.back_button{
			margin-top: 10px;
		}
		
	</style>
<%end%>

		<%if @show_table%>
			<table id="select_items_table"></table>
		<%else%>
			<div id="message_id" class="alert alert-info" align="center">
				<strong><%=@message%></strong>
    		</div>
		<%end%>
		<div class="back_button" align="center">
			<button class="btn" id="back_button" ><i class="icon-arrow-left"></i> <strong>Повернутися до фільтру</strong></button>
		</div>	
